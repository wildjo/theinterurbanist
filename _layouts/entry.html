---
layout: default
---
{%- assign default_entry_format = site.date_formats.entry_default | default: "%b %-d, %Y" -%}
{%- assign page_section_slug = page.section | to_s | strip | downcase -%}
{%- assign page_section = site.sections | where:"slug", page_section_slug | first -%}
{%- if page_section == blank -%}
  {%- assign page_section = site.sections[page_section_slug] -%}
{%- endif -%}
{%- assign page_entry_settings = nil -%}
{%- if page_section and page_section.entry -%}
  {%- assign page_entry_settings = page_section.entry -%}
{%- endif -%}
{%- capture page_entry_format -%}{% include resolve_date_format.html settings=page_entry_settings doc=page default=default_entry_format %}{%- endcapture -%}
<article class="entry" itemscope itemtype="https://schema.org/Article">
  <header class="entry-header">
    <h1 class="entry-title" itemprop="headline">{{ page.title }}</h1>
    <div class="meta">
      <time
        datetime="{% include date.html doc=page format='%Y-%m-%dT%H:%M:00%z' %}"
        itemprop="datePublished">
        {% include date.html doc=page format=page_entry_format %}
      </time>
      {% if page.author %} · <span class="author" itemprop="author">{{ page.author }}</span>{% endif %}
      {% if page.type %} · <span class="type">{{ page.type }}</span>{% endif %}
      {% if page.last_modified_at %}
        <meta itemprop="dateModified" content="{{ page.last_modified_at | date_to_xmlschema }}">
      {% endif %}
      {% if page.summary %}
        <meta itemprop="description" content="{{ page.summary }}">
      {% endif %}
    </div>
  </header>

  {% if page.images and page.images.size > 1 %}
    <section class="gallery" aria-label="Image gallery" itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
      <div class="gallery-strip">
        {% for img in page.images %}
          {%- capture resolved -%}{% include media_url.html src=img.src item=page %}{%- endcapture -%}
          {%- assign resolved = resolved | strip -%}
          {%- if resolved == '' -%}
            {%- assign resolved = img.src | to_s | strip -%}
          {%- endif -%}

          <a href="{{ resolved | relative_url }}" class="lb" data-group="fm">
            <img src="{{ resolved | relative_url }}" alt="{{ img.alt | default: '' }}">
          </a>

          <!-- Schema.org image candidate -->
          <meta itemprop="url" content="{{ resolved | absolute_url }}">
        {% endfor %}
      </div>
      {% if page.images[0].caption %}<p class="cap">{{ page.images[0].caption }}</p>{% endif %}
    </section>

  {% elsif page.images and page.images.size == 1 %}
    {%- assign hero_image = page.images | first -%}
    {%- capture resolved -%}{% include media_url.html src=hero_image.src item=page %}{%- endcapture -%}
    {%- assign resolved = resolved | strip -%}
    {%- if resolved == '' -%}
      {%- assign resolved = hero_image.src | to_s | strip -%}
    {%- endif -%}

    <figure class="hero" itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
      <a href="{{ resolved | relative_url }}" class="lb" data-group="single">
        <img src="{{ resolved | relative_url }}" alt="{{ hero_image.alt | default: '' }}">
      </a>
      {% if hero_image.caption %}<figcaption>{{ hero_image.caption }}</figcaption>{% endif %}
      <!-- Schema.org image candidate -->
      <meta itemprop="url" content="{{ resolved | absolute_url }}">
    </figure>
  {% endif %}

  <div class="entry-body" itemprop="articleBody">
    {{ content }}
  </div>

  {% if page.videos and page.videos.size > 0 %}
  <section class="videos">
    <h2>Videos</h2>
    <div class="video-grid">
      {% for v in page.videos %}
        {% include video_embed.html url=v.url title=v.description %}
      {% endfor %}
    </div>
  </section>
  {% endif %}
</article>
