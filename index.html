---
layout: default
title: Home
---

{% assign default_card_format = site.date_formats.card_default | default: "%b %-d, %Y" %}

{%- comment -%}
  Build a unified list of all entries for Timeline view
{%- endcomment -%}
{% assign all_entries = site.pages | where: "layout", "entry" %}

<!-- ========================================================================
     TIMELINE VIEW (Default) - All stories, newest first, vertical scroll
     ======================================================================== -->
<div class="timeline-view">
  {% capture _rows %}
  {% for entry in all_entries %}
    {% if entry.date %}
      {% assign ts = entry.date | date: '%s' %}

      {%- comment -%} Get section info {%- endcomment -%}
      {% assign sec_slug = entry.section | to_s | strip | downcase %}
      {% assign sec_obj = site.sections | where: "slug", sec_slug | first %}
      {% if sec_obj == blank %}
        {% assign sec_obj = site.sections[sec_slug] %}
      {% endif %}
      {% if sec_obj and sec_obj.label %}
        {% assign sec_label = sec_obj.label %}
      {% elsif sec_slug != '' %}
        {% assign sec_label = sec_slug | replace: '-', ' ' | capitalize %}
      {% else %}
        {% assign sec_label = '' %}
      {% endif %}

      {%- comment -%} Get card settings for this section {%- endcomment -%}
      {% assign card_settings = nil %}
      {% if sec_obj and sec_obj.card %}
        {% assign card_settings = sec_obj.card %}
      {% endif %}

      {% capture li %}
      <li>
        <a class="card" href="{{ entry.url | relative_url }}">
          {% assign hero = entry.images | first %}
          <div class="card-media">
            {% if hero %}
              {%- capture resolved -%}{% include media_url.html src=hero.src item=entry %}{%- endcapture -%}
              {%- assign resolved = resolved | strip -%}
              {% if resolved != '' %}
                <img src="{{ resolved | relative_url }}" alt="{{ hero.alt | default: '' }}" loading="lazy">
              {% else %}
                <img src="{{ site.placeholders.card | default: '/assets/placeholders/placeholder_card_400x300.png' | relative_url }}" alt="">
              {% endif %}
            {% else %}
              <img src="{{ site.placeholders.card | default: '/assets/placeholders/placeholder_card_400x300.png' | relative_url }}" alt="">
            {% endif %}
          </div>
          <div class="card-body">
            <div class="card-top-row">
              <span class="card-section">{{ sec_label }}</span>
              <time class="card-date">
                {%- capture card_fmt -%}{% include resolve_date_format.html settings=card_settings doc=entry default=default_card_format %}{%- endcapture -%}
                {% include date.html doc=entry format=card_fmt %}
              </time>
            </div>
            <h3 class="card-title">{{ entry.title }}</h3>
            {% if entry.summary %}<p class="card-summary">{{ entry.summary }}</p>{% endif %}
          </div>
        </a>
      </li>
      {% endcapture %}
      {{ ts }}|||{{ entry.url }}|||{{ li | strip_newlines }}{{ '
' }}
    {% endif %}
  {% endfor %}
  {% endcapture %}

  {% assign lines = _rows | split: '
' | compact %}
  {% assign sorted = lines | sort | reverse %}

  <ul class="timeline-list">
    {% for row in sorted limit: 60 %}
      {% assign parts = row | split: '|||' %}
      {{ parts[2] }}
    {% endfor %}
  </ul>

  {%- comment -%} Show entries missing dates {%- endcomment -%}
  {% assign invalid = all_entries | where_exp: "p", "p.date == nil" %}
  {% if invalid and invalid.size > 0 %}
    <div class="timeline-errors" style="background: #fff3cd; border: 2px solid #856404; padding: 1rem; border-radius: 8px; margin-top: 2rem;">
      <h3 style="margin: 0 0 0.5rem; color: #856404;">Missing dates</h3>
      <p style="margin: 0 0 0.5rem;">Add <code>date: YYYY-MM-DD</code> to the front-matter of these pages:</p>
      <ul style="margin: 0; padding-left: 1.5rem;">
        {% for e in invalid %}
          <li><a href="{{ e.url | relative_url }}">{{ e.title | default: e.url }}</a></li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
</div>

<!-- ========================================================================
     SECTIONS VIEW - Horizontal scroll between sections, vertical within
     ======================================================================== -->
<div class="sections-view">
  <div class="sections-strip" tabindex="0" aria-label="Sections - use left/right arrows to navigate">
    {% for s in site.sections %}
      {% assign label = s.label %}
      {% assign slug = s.slug %}

      {%- comment -%} Get entries for this section {%- endcomment -%}
      {% assign collection = site.pages | where: "section", slug %}
      
      {%- comment -%} Sort entries {%- endcomment -%}
      {% assign sort_key = 'path' %}
      {% assign sort_direction = 'desc' %}
      {% if s.sort %}
        {% if s.sort.key %}{% assign sort_key = s.sort.key %}{% endif %}
        {% if s.sort.direction %}{% assign sort_direction = s.sort.direction %}{% endif %}
      {% endif %}
      {% assign list = collection | sort: sort_key %}
      {% assign normalized_direction = sort_direction | to_s | downcase | strip %}
      {% if normalized_direction == 'desc' %}
        {% assign list = list | reverse %}
      {% endif %}

      {% assign card_settings = s.card %}

      <section class="section-column">
        <header class="section-header">
          <h2>{{ label }}</h2>
        </header>
        <ul class="section-list">
          {% for entry in list limit: 20 %}
            <li>
              <a class="card card-compact" href="{{ entry.url | relative_url }}">
                {% assign hero = entry.images | first %}
                <div class="card-media">
                  {% if hero %}
                    {%- capture resolved -%}{% include media_url.html src=hero.src item=entry %}{%- endcapture -%}
                    {%- assign resolved = resolved | strip -%}
                    {% if resolved != '' %}
                      <img src="{{ resolved | relative_url }}" alt="{{ hero.alt | default: '' }}" loading="lazy">
                    {% else %}
                      <img src="{{ site.placeholders.card | default: '/assets/placeholders/placeholder_card_400x300.png' | relative_url }}" alt="">
                    {% endif %}
                  {% else %}
                    <img src="{{ site.placeholders.card | default: '/assets/placeholders/placeholder_card_400x300.png' | relative_url }}" alt="">
                  {% endif %}
                </div>
                <div class="card-body">
                  <div class="card-top-row">
                    <span class="card-section">{{ label }}</span>
                    <time class="card-date">
                      {%- capture card_fmt -%}{% include resolve_date_format.html settings=card_settings doc=entry default=default_card_format %}{%- endcapture -%}
                      {% include date.html doc=entry format=card_fmt %}
                    </time>
                  </div>
                  <h3 class="card-title">{{ entry.title }}</h3>
                  {% if card_settings.show_location and entry.location %}
                    <p class="card-meta">{{ entry.location }}</p>
                  {% endif %}
                </div>
              </a>
            </li>
          {% endfor %}
        </ul>
      </section>
    {% endfor %}
  </div>
</div>
